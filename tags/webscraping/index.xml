<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>webscraping | Joseph V. Casillas</title>
    <link>/tags/webscraping/</link>
      <atom:link href="/tags/webscraping/index.xml" rel="self" type="application/rss+xml" />
    <description>webscraping</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>Joseph V. Casillas © 2019 </copyright><lastBuildDate>Tue, 16 Jun 2015 21:13:14 -0500</lastBuildDate>
    <image>
      <url>/img/jvc2016.png</url>
      <title>webscraping</title>
      <link>/tags/webscraping/</link>
    </image>
    
    <item>
      <title>How to scrape data from Google Sheets in R</title>
      <link>/post/2015-06-16_google_sheets_in_r/</link>
      <pubDate>Tue, 16 Jun 2015 21:13:14 -0500</pubDate>
      <guid>/post/2015-06-16_google_sheets_in_r/</guid>
      <description>


&lt;p&gt;Google Forms offers a convenient way to collect data online. It is particularly
useful because you can embed the form in a webpage, link the results with a
spreadsheet and publish the results online. This post shows how to scrape the
data from the spreadsheet (google form) in &lt;code&gt;r&lt;/code&gt; using the package &lt;code&gt;RCurl&lt;/code&gt;. You
should be able to follow along by copying and pasting the code into an R
session.&lt;/p&gt;
&lt;p&gt;Ideally you can use this method once you have collected data using a google
form. For our purposes I just created a google sheet and I will scrape the data
from there.&lt;/p&gt;
&lt;div id=&#34;get-some-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Get some data&lt;/h3&gt;
&lt;p&gt;To show how this works, I simulated some data with the following code:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# create fake data
# to save in google sheet

set.seed(1)
df &amp;lt;- data.frame(
    subj = 1:30, 
    group = gl(2, 15, labels = c(&amp;quot;mono&amp;quot;, &amp;quot;bi&amp;quot;)), 
    score = c(rnorm(15, 87, 8), rnorm(15, 94, 3))
    )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I then copy and pasted the data frame into a google sheet. To do this, open
google drive and create a new sheet.&lt;/p&gt;
&lt;p&gt;&lt;img width=&#34;400&#34; src=&#34;./img/data.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Once you have some data in a sheet you
need to do a few things before you are ready to fire up R.&lt;/p&gt;
&lt;p&gt;First, you need to publish your sheet to the web (File &amp;gt; Publish to the web…):&lt;/p&gt;
&lt;p&gt;&lt;img width=&#34;400&#34; src=&#34;./img/publish.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Publish the sheet and copy the public link from the window.&lt;/p&gt;
&lt;p&gt;&lt;img width=&#34;400&#34; src=&#34;./img/link.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;As you can see, my link is:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://docs.google.com/spreadsheets/d/1AqS_DAThPUJuS2L2E-S5X7fM1kpIdhXQdBDZUyt-bWM/pubhtml&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Copy your link and save it somewhere. We will
need it in just a second.&lt;/p&gt;
&lt;p&gt;Now we’re ready for R. Here are the packages I used:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# load libraries

library(dplyr); library(tidyr); library(RCurl)
library(ggplot2); library(DT); library(pander)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;scrape&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Scrape&lt;/h3&gt;
&lt;p&gt;We will use the &lt;code&gt;RCurl&lt;/code&gt; package to scrape the data. The command we need is
&lt;code&gt;getForm()&lt;/code&gt;. The first arguement represents the URI to which the form is posted.
You can just use the one shown below for a google sheet. The important part here
is the &lt;code&gt;key&lt;/code&gt; arguement. You need to copy it from the link you saved above. The
key can be found in the last part of the link. Here is my link again:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;https://docs.google.com/spreadsheets/d/1AqS_DAThPUJuS2L2E-S5X7fM1kpIdhXQdBDZUyt-bWM/pubhtml&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Specifically we want:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1AqS_DAThPUJuS2L2E-S5X7fM1kpIdhXQdBDZUyt-bWM&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Therefore we can delete &lt;code&gt;https://docs.google.com/spreadsheets/d/&lt;/code&gt; from the
beginning, as well as &lt;code&gt;/pubhtml&lt;/code&gt; from the end. Check the &lt;code&gt;key&lt;/code&gt; arguement below.
Finally, we use the &lt;code&gt;read.csv()&lt;/code&gt; command to import the data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# scrape data

sheet = getForm(&amp;quot;https://spreadsheets.google.com/spreadsheet/pub&amp;quot;, 
                hl =&amp;quot;en_US&amp;quot;, 
                key = &amp;quot;1AqS_DAThPUJuS2L2E-S5X7fM1kpIdhXQdBDZUyt-bWM&amp;quot;, 
                output = &amp;quot;csv&amp;quot;, 
                .opts = list(followlocation = TRUE, 
                             verbose = TRUE, 
                             ssl.verifypeer = FALSE)) 

df &amp;lt;- read.csv(textConnection(sheet))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s see if it worked…&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pandoc.table(df, style = &amp;quot;rmarkdown&amp;quot;, round = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;center&#34;&gt;subj&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;group&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;score&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;81.99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;88.47&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;80.31&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;99.76&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;89.64&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;80.44&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;90.9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;92.91&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;91.61&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;84.56&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;99.09&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;90.12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;13&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;82.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;69.28&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;mono&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;96&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;93.87&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;93.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;18&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;96.83&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;96.46&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;95.78&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;96.76&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;22&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;96.35&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;94.22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;88.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;25&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;95.86&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;93.83&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;27&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;93.53&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;89.59&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;center&#34;&gt;29&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;92.57&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;bi&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;95.25&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Looks good. Now we can visualize and analyze the data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;%
  ggplot(., aes(x = as.numeric(group), y = score)) +
  scale_x_discrete(limits = c(2, 1), labels = c(&amp;quot;Bilingual&amp;quot;, &amp;quot;Monolingual&amp;quot;)) +
  geom_jitter() +
  geom_point() +
  geom_smooth(method = &amp;quot;lm&amp;quot;) + 
  labs(x = &amp;quot;Group&amp;quot;, y = &amp;quot;Score&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img width=&#34;650&#34; src=&#34;./img/plot1.pdf&#34;&gt;&lt;/p&gt;
&lt;p&gt;And that’s it.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
